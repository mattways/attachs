<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title></title>
    <script>
      function uploadFile() {
        var file = document.getElementById('file').files[0];
        var form = new FormData();

        form.append('key', key);
        form.append('acl', 'private');
        form.append('Content-Type', 'application/octet-stream');
        form.append('AWSAccessKeyId', id);
        form.append('policy', policy)
        form.append('signature', signature);
        form.append('file', file);

        var xhr = new XMLHttpRequest();

        xhr.upload.addEventListener('progress', uploadProgress);
        xhr.addEventListener('load', uploadComplete);
        xhr.addEventListener('error', uploadFailed);
        xhr.addEventListener('abort', uploadCanceled);
        xhr.open('POST', 'https://attachs-test.s3.amazonaws.com/');
        xhr.send(form);
      }

      function uploadProgress(event) {
        var element = document.getElementById('progressNumber');
        if (event.lengthComputable) {
          var percentComplete = Math.round(event.loaded * 100 / event.total);
          element.innerHTML = percentComplete.toString() + '%';
        }
        else {
          element.innerHTML = 'unable to compute';
        }
      }

      function uploadComplete(event) {
        console.debug(event.target.responseText);
      }

      function uploadFailed(event) {
        console.debug(event);
      }

      function uploadCanceled(event) {
        console.debug(event);
      }
    </script>
  </head>
  <body>
    <form id="form" enctype="multipart/form-data" method="post">
      <label for="file">Select a File to Upload</label><br />
      <input type="file" name="file" id="file" />
      <div id="fileName"></div>
      <div id="fileSize"></div>
      <div id="fileType"></div>
      <input type="button" onclick="uploadFile()" value="Upload" />
      <div id="progressNumber"></div>
    </form>
  </body>
</html>
